const language="eng",debug=!0,freeTrialLink="https://www.acuvue.co.uk/get-contact-lenses/free-trial-contact-lenses",learnMoreLink="https://www.acuvue.co.uk/eye-problems/astigmatism",tsAndCsLink="https://www.acuvue.co.uk/terms-conditions";let winSize,main,u,targetPositionY,targetPositionX,status;window.onload=function(){function e(){const e=new cc.LayerColor(cc.color(255,255,255,255));main.addChild(e,2),u.setLayer(e),u.addSprite(u.langRes("background.png")),u.addSprite(u.langRes("glasses-or-contacts-background.png"),u.xcyo(248)),u.addMenuButton(u.langRes("wearing-glasses.png"),u.xcyo(611),(()=>{main.removeChild(e),function(){let e=null;const i=t(4,"glasses-guide",(()=>function(){let e=1,t={left:null,right:null},i="right",a=[];const o=new cc.LayerColor(cc.color(18,42,96));o.setPosition(cc.p(0,0)),main.addChild(o),u.setLayer(o),u.addSprite(u.langRes("glasses-test-background.png"));const c=(e=(()=>{}))=>{const t=u.addSprite(u.res("camera-button.png"),u.xoyo(436,1023)),n=new cc.LayerColor(cc.color(255,255,255));n.setPosition(cc.p(0,0)),o.addChild(n),h.setVisible(!0),n.runAction(cc.sequence([cc.DelayTime.create(.1),cc.callFunc((()=>{t.setVisible(!0)})),cc.FadeOut.create(1),cc.callFunc((()=>n.setVisible(!1))),cc.FadeIn.create(0),cc.DelayTime.create(.2),cc.callFunc(e)]))},g=()=>{e+=1;const o=()=>{r.setTexture(u.langRes(`glasses-test-text${e}.png`)),a.forEach(((t,n)=>{n+1===e?t.setTexture(u.res("progress-indicator-small-on.png")):t.setTexture(u.res("progress-indicator-small-off.png"))}))};2===e&&(d.setVisible(!0),p.setVisible(!0),l.setVisible(!1),m.setVisible(!1),o()),3===e&&(d.setEnabled(!1),p.setEnabled(!1),n(u.langRes("loading-text-close-right-eye.png"),(()=>{d.setVisible(!1),p.setVisible(!1),l.setVisible(!1),m.setVisible(!0),i="left",o()}))),4===e&&(d.setEnabled(!0),p.setEnabled(!0),d.setVisible(!0),p.setVisible(!0),l.setVisible(!1),m.setVisible(!1),o()),5===e&&(d.setEnabled(!1),p.setEnabled(!1),c((()=>{const e=n(u.langRes("loading-text-complete.png"),(()=>{main.removeChild(e),s(t.left,t.right)}))})))},r=u.addSprite(u.langRes("glasses-test-text1.png"),u.xcyo(1305)),l=u.addMenuButton(u.langRes("go-button-wide.png"),u.xoyo(55,1717),g);l.setEnabled(!1);const d=u.addMenuButton(u.langRes("yes-button.png"),u.xoyo(55,1717),(()=>{t[i]="astigmatism",g()}));d.setVisible(!1);const p=u.addMenuButton(u.langRes("no-button.png"),u.xoyo(566,1717),(()=>{t[i]="no-astigmatism",g()}));p.setVisible(!1);const m=u.addMenuButton(u.langRes("next-button-wide.png"),u.xoyo(55,1717),g);m.setVisible(!1);const h=u.addSprite(u.res("light-photo.png"),u.xoyo(76,88));h.setVisible(!1);const b=4,R=88,w=winSize.width/2-(b-1)/2*R;for(let t=0;t<b;t++){const n=t===e-1?"on":"off",s=cc.Sprite.create(u.res(`progress-indicator-small-${n}.png`));s.setPosition(cc.p(w+t*R,winSize.height-1644)),o.addChild(s),a.push(s)}n(u.langRes("loading-text-close-left-eye.png"),(()=>{l.setEnabled(!0)}))}()),(t=>{2===t&&null===e&&(e=cc.Sprite.create(u.res("glasses.png")),e.setPosition(cc.p(705,winSize.height-635)),e.setAnchorPoint(.8,.5),e.setVisible(!1),i.addChild(e)),2===t&&e.setVisible(!1),3===t&&e.setVisible(!0),4===t&&e.runAction(cc.sequence([cc.RotateTo.create(.8,-30),cc.RotateTo.create(.8,0),cc.RotateTo.create(.8,30),cc.RotateTo.create(.8,0),cc.RotateTo.create(.8,-30)]))}))}()})),u.addMenuButton(u.langRes("wearing-contacts.png"),u.xcyo(1099),(()=>{main.removeChild(e),function(){let e=null;const i=t(3,"contacts-guide",(()=>function(){let e=1,t=null,i={left:null,right:null},a="right",o=[];const c=new cc.LayerColor(cc.color(18,42,96));function g(){function e(e){return Math.atan2(e.x-targetPositionX,e.y-targetPositionY)*(180/Math.PI)+90}function n(t,n){const s=e(n.getCurrentTarget().convertToNodeSpace(t.getLocation()));return s>=0&&s<=177?s:null}t=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:function(){return!0},onTouchMoved:function(e,t){const s=n(e,t);if(null!==s){const e=s-90;p.setRotation(e)}return!0},onTouchEnded:function(){}}),cc.eventManager.addListener(t,main);const s=.4;p.runAction(cc.Repeat.create(cc.sequence([cc.RotateTo.create(s,-20),cc.RotateTo.create(s,0),cc.RotateTo.create(s,20),cc.RotateTo.create(s,0)]),1))}function r(){cc.eventManager.removeListener(t,main)}function l(){o.forEach(((t,n)=>{n+1===e?t.setTexture(u.res("progress-indicator-small-on.png")):t.setTexture(u.res("progress-indicator-small-off.png"))}))}function d(t=null){null!==t?e=t:e+=1;const o=()=>{const t={1:1,2:2,3:3,4:4,5:2,6:3};h.setTexture(u.langRes("contacts-test-text"+t[e]+".png")),l()};2!==e&&5!==e||(g(),b.setVisible(!1),R.setVisible(!1),w.setVisible(!0),o()),3!==e&&6!==e||(r(),b.setVisible(!0),R.setVisible(!0),w.setVisible(!1),m.setVisible(!0),o()),4===e&&(a="left",b.setEnabled(!1),R.setEnabled(!1),n(u.langRes("loading-text-next-eye.png"),(()=>{b.setEnabled(!0),R.setEnabled(!0),p.setRotation(0),m.setVisible(!1),o()}))),7===e&&(b.setEnabled(!1),R.setEnabled(!1),n(u.langRes("loading-text-complete.png"),(()=>{m.setVisible(!1),s(i.left,i.right)})))}c.setPosition(cc.p(0,0)),main.addChild(c),u.setLayer(c),u.addSprite(u.res("contacts-test-background.png"));const p=u.addSprite(u.res("arrow.png"),u.xcyo(1186));p.setAnchorPoint(.5,0);const m=cc.Sprite.create(u.res("box_n.png"));m.setPosition(cc.p(5,-40)),m.setVisible(!1),p.addChild(m),targetPositionX=p.getPosition().x,targetPositionY=p.getPosition().y;const h=u.addSprite(u.langRes("contacts-test-text1.png"),u.xcyo(1305)),b=u.addMenuButton(u.langRes("yes-button.png"),u.xoyo(51,1716),(()=>{1!==e&&4!==e||(i[a]="astigmatism"),3!==e&&6!==e||(i[a]="high-astigmatism"),d()})),R=u.addMenuButton(u.langRes("no-button.png"),u.xoyo(552,1716),(()=>1===e?(i[a]="no-astigmatism",void d(4)):4===e?(i[a]="no-astigmatism",void d(7)):void d())),w=u.addMenuButton(u.langRes("next-button-wide.png"),u.xcyo(1716),(()=>d()));w.setTag("next-button"),w.setVisible(!1);const f=6,x=88,S=winSize.width/2-(f-1)/2*x;for(let e=0;e<f;e++){const t=0===e?"on":"off",n=cc.Sprite.create(u.res(`progress-indicator-small-${t}.png`));n.setPosition(cc.p(S+e*x,winSize.height-1644)),c.addChild(n),o.push(n)}}()),(t=>{3===t&&null===e&&(e=cc.Sprite.create(u.res("hand.png")),e.setPosition(cc.p(705,winSize.height-685)),e.setVisible(!1),i.addChild(e),e.runAction(cc.sequence([cc.FadeOut.create(0),cc.DelayTime.create(1),cc.callFunc((()=>e.setVisible(!0))),cc.Spawn.create(cc.FadeIn.create(.5),cc.MoveTo.create(2,cc.p(805,winSize.height-630)))]))),2===t&&null!==e&&(e.setVisible(!1),i.removeChild(e),e=null)}))}()}))}function t(t,n,s,i=(()=>{})){let a=1;const o=new cc.LayerColor(cc.color(2,4,63,255));function c(){l.setTexture(u.langRes(n+"-text"+a+".png")),r.setTexture(u.langRes(n+"-image"+a+".png"));const e=o.getChildByTag("next-button"),s=a<t;e.setVisible(s);const c=a===t;d.setVisible(c),g(a),i(a)}main.addChild(o),u.setLayer(o),u.addSprite(u.langRes("background.png"));const g=function(e){const t=[],n=u.res("progress-indicator-off.png"),s=u.res("progress-indicator-on.png"),i=winSize.width/2-132*e/2;for(let a=0;a<e;a++){const e=0===a?s:n,o=u.addSprite(e,u.xoyo(i+132*a,1565));t.push(o)}return function(e){t.forEach(((t,i)=>{const a=i===e-1?s:n;t.setTexture(a)}))}}(t),r=cc.Sprite.create();r.setPosition(cc.p(winSize.width/2,winSize.height-609)),o.addChild(r);const l=cc.Sprite.create();l.setPosition(cc.p(winSize.width/2,winSize.height-1260)),o.addChild(l),u.addMenuButton(u.langRes("back-button.png"),u.xoyo(55,1717),(()=>{1===a?(main.removeChild(o),e()):(a-=1,c())})),u.addMenuButton(u.langRes("next-button.png"),u.xoyo(566,1717),(()=>(a+=1,void c()))).setTag("next-button");const d=u.addMenuButton(u.langRes("go-button.png"),u.xoyo(566,1717),(()=>(main.removeChild(o),void s())));return d.setVisible(!1),c(),o}function n(e,t){const n=new cc.LayerColor(cc.color(0,0,0,200));n.setPosition(cc.p(0,0)),main.addChild(n,5);const s=cc.Sprite.create(e);s.setPosition(cc.p(winSize.width/2,winSize.height/2+90)),n.addChild(s);const i=cc.Sprite.create(u.res("loading-spinner.png"));return i.setPosition(cc.p(winSize.width/2,winSize.height/2-270)),n.addChild(i),i.runAction(cc.sequence([cc.RotateTo.create(3,1080),cc.callFunc((()=>main.removeChild(n)),main),cc.callFunc(t,main)])),n}function s(e,t){const n=new cc.LayerColor(cc.color(2,4,63,255));n.setPosition(cc.p(0,0)),main.addChild(n,2),u.setLayer(n);const s=cc.Sprite.create(u.langRes("background.png"));s.setPosition(cc.p(winSize.width/2,winSize.height/2)),n.addChild(s);const i=cc.Sprite.create(u.res("result-background.png"));i.setPosition(cc.p(winSize.width/2,winSize.height-1058)),n.addChild(i),u.addMenuButton(u.langRes("download-free-trial-voucher.png"),u.xcyo(1246),(()=>window.location.href=freeTrialLink)),u.addMenuButton(u.langRes("learn-more-about-astigmatism.png"),u.xcyo(1424),(()=>window.location.href=learnMoreLink)),u.addMenuButton(u.langRes("terms-and-conditions.png"),u.xcyo(1617),(()=>window.location.href=tsAndCsLink));const a=[];a["no-astigmatism"]=[],a["no-astigmatism"]["no-astigmatism"]="no-astigmatism",a["no-astigmatism"].astigmatism="astigmatism-right",a["no-astigmatism"]["high-astigmatism"]="astigmatism-right",a.astigmatism=[],a.astigmatism["no-astigmatism"]="astigmatism-left",a.astigmatism.astigmatism="astigmatism-both",a.astigmatism["high-astigmatism"]="astigmatism-both",a["high-astigmatism"]=[],a["high-astigmatism"]["no-astigmatism"]="astigmatism-left",a["high-astigmatism"].astigmatism="astigmatism-both",a["high-astigmatism"]["high-astigmatism"]="astigmatism-both";const o=a[e][t],c=cc.Sprite.create(u.langRes("result-"+o+".png"));c.setPosition(cc.p(winSize.width/2,winSize.height-804)),n.addChild(c)}cc.game.onStart=function(){cc.director.setProjection(cc.Director.PROJECTION_3D);const t=new cc.ResolutionPolicy(cc.ContainerStrategy.PROPORTION_TO_FRAME,cc.ContentStrategy.SHOW_ALL);cc.view.setDesignResolutionSize(1080,1920,t),cc.view.resizeWithBrowserSize(!0),cc.view.enableAutoFullScreen(!0),cc.director.setDisplayStats(!1),u=new Utils({windowSize:cc.director.getWinSize(),resourcesDir:"resources",resourcesLangDir:"resources/eng"}),u.preload([u.langRes("part2bg.png"),u.langRes("get-a-free-trial.png"),u.langRes("get-a-free-trial (pressed).png"),u.langRes("start-button.png"),u.langRes("start-button (pressed).png"),u.langRes("get-a-free-trial.png"),u.langRes("get-a-free-trial (pressed).png"),u.langRes("background.png"),u.langRes("glasses-or-contacts-background.png"),u.langRes("wearing-glasses.png"),u.langRes("wearing-glasses (pressed).png"),u.langRes("wearing-contacts.png"),u.langRes("wearing-contacts (pressed).png"),u.res("progress-indicator-off.png"),u.res("progress-indicator-on.png"),u.langRes("contacts-guide-text1.png"),u.langRes("contacts-guide-text2.png"),u.langRes("contacts-guide-text3.png"),u.langRes("contacts-guide-image1.png"),u.langRes("contacts-guide-image2.png"),u.langRes("contacts-guide-image3.png"),u.langRes("background.png"),u.langRes("back-button.png"),u.langRes("back-button (pressed).png"),u.langRes("next-button.png"),u.langRes("next-button (pressed).png"),u.langRes("go-button.png"),u.langRes("go-button (pressed).png"),u.res("glasses.png"),u.res("hand.png"),u.res("loading-spinner.png"),u.langRes("loading-text-next-eye.png"),u.langRes("loading-text-complete.png"),u.langRes("loading-text-close-left-eye.png"),u.langRes("loading-text-close-right-eye.png"),u.res("progress-indicator-small-on.png"),u.res("progress-indicator-small-off.png"),u.langRes("contacts-test-text1.png"),u.langRes("contacts-test-text2.png"),u.langRes("contacts-test-text3.png"),u.langRes("contacts-test-text4.png"),u.res("contacts-test-background.png"),u.res("arrow.png"),u.res("box_n.png"),u.langRes("yes-button.png"),u.langRes("yes-button (pressed).png"),u.langRes("no-button.png"),u.langRes("no-button (pressed).png"),u.langRes("next-button-wide.png"),u.langRes("next-button-wide (pressed).png"),u.langRes("glasses-test-text1.png"),u.langRes("glasses-test-text2.png"),u.langRes("glasses-test-text3.png"),u.langRes("glasses-test-text4.png"),u.langRes("glasses-test-background.png"),u.langRes("glasses-guide-text1.png"),u.langRes("glasses-guide-text2.png"),u.langRes("glasses-guide-text3.png"),u.langRes("glasses-guide-text4.png"),u.langRes("glasses-guide-image1.png"),u.langRes("glasses-guide-image2.png"),u.langRes("glasses-guide-image3.png"),u.langRes("glasses-guide-image4.png"),u.langRes("go-button-wide.png"),u.langRes("go-button-wide (pressed).png"),u.res("camera-button.png"),u.res("light-photo.png"),u.res("result-background.png"),u.langRes("download-free-trial-voucher.png"),u.langRes("download-free-trial-voucher (pressed).png"),u.langRes("learn-more-about-astigmatism.png"),u.langRes("learn-more-about-astigmatism (pressed).png"),u.langRes("terms-and-conditions.png"),u.langRes("result-no-astigmatism.png"),u.langRes("result-astigmatism-left.png"),u.langRes("result-astigmatism-right.png"),u.langRes("result-astigmatism-both.png")]),cc._loaderImage=u.langRes("part2bg.png"),cc.LoaderScene.preload([u.langRes("part2bg.png")],(function(){const t=cc.Scene.extend({onEnter:function(){this._super(),cc.view.enableAutoFullScreen(!0),winSize=cc.director.getWinSize(),main=this;const t=new cc.LayerColor(cc.color(2,4,63,255));t.setPosition(cc.p(0,0)),main.addChild(t),function(){const t=new cc.LayerColor(cc.color(255,255,255,255));main.addChild(t,2),u.setLayer(t),u.addSprite(u.langRes("part2bg.png")),u.addMenuButton(u.langRes("start-button.png"),u.xcyo(1142),(()=>{main.removeChild(t),e()})),u.addMenuButton(u.langRes("get-a-free-trial.png"),u.xcyo(1332),(()=>window.location.href=freeTrialLink))}(),this._gameHideListener=cc.EventListener.create({event:cc.EventListener.CUSTOM,eventName:cc.game.EVENT_HIDE,callback:function(){cc.director.setDisplayStats(!1)}}),cc.eventManager.addListener(this._gameHideListener,1),this._gameShowListener=cc.EventListener.create({event:cc.EventListener.CUSTOM,eventName:cc.game.EVENT_SHOW,callback:function(){cc.director.setDisplayStats(!1)}}),cc.eventManager.addListener(this._gameShowListener,1),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:function(e){var t=e.getCurrentTarget();const n=function e(t){if(0===t.children.length)return[];const n=[];for(const s of t.children)!1===s.visible||"Menu"===s._className&&!1===s.isEnabled()||("MenuItem"===s._className&&!0===s.visible?n.push(s):n.push(...e(s)));return n}(t);if(0===n.length)return void(cc.$("#gameCanvas").style.cursor="default");var s=t.convertToNodeSpace(e.getLocation());let i=!1;for(const e of n){var a=e.rect();if(cc.rectContainsPoint(a,s)){i=!0;break}}cc.$("#gameCanvas").style.cursor=i?"pointer":"default"}},this)}});cc.director.runScene(new t)}),this)},cc.game.run("gameCanvas")};